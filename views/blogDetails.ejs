<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>
        <%= blog.metaTitle %>
    </title>
    <meta name="description" content="<%= blog.metaDescription %>">
    <meta name="keywords" content="<%= blog.metaKeywords %>">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.6.0/css/all.min.css" integrity="sha512-Kc323vGBEqzTmouAECnVceyQqyqdsSiqLQISBL29aUW4U/M7pSPA/gEUZQqv1cwx4OnYxTxve5UMg5GT6L4JJg==" crossorigin="anonymous" referrerpolicy="no-referrer" />
    <link rel="canonical" href="https://www.shashisales.com/blog-detail/<%= blog.canonical %>">
    <link rel="stylesheet" href="/css/blog.css">
    <link rel="stylesheet" href="/css/home.css">
    <link rel="stylesheet" href="/css/responsive.css">
    <link rel="stylesheet" href="/css/style.css">

    <script>
        !function (f, b, e, v, n, t, s) {
            if (f.fbq) return; n = f.fbq = function () {
                n.callMethod ?
                    n.callMethod.apply(n, arguments) : n.queue.push(arguments)
            };
            if (!f._fbq) f._fbq = n; n.push = n; n.loaded = !0; n.version = '2.0';
            n.queue = []; t = b.createElement(e); t.async = !0;
            t.src = v; s = b.getElementsByTagName(e)[0];
            s.parentNode.insertBefore(t, s)
        }(window, document, 'script',
            'https://connect.facebook.net/en_US/fbevents.js');
        fbq('init', '1007318860933777');
        fbq('track', 'PageView');
    </script>

    <!-- Google tag (gtag.js) -->
    <script>
        // Define dataLayer and the gtag function.
        window.dataLayer = window.dataLayer || [];
        function gtag() {
            dataLayer.push(arguments);
        }

        // Set default consent to 'denied' as a placeholder
        // Determine actual values based on your own requirements
        gtag("consent", "default", {
            ad_storage: "denied",
            ad_user_data: "denied",
            ad_personalization: "denied",
            analytics_storage: "denied",
            functionality_storage: "granted",
            personalization_storage: "granted",
            security_storage: "granted",
        });

        var allGranted = {
            ad_storage: "granted",
            ad_user_data: "granted",
            ad_personalization: "granted",
            analytics_storage: "granted",
            functionality_storage: "granted",
            personalization_storage: "granted",
            security_storage: "granted",
        };

        var essentialOnlyGranted = {
            ad_storage: "denied",
            ad_user_data: "denied",
            ad_personalization: "denied",
            analytics_storage: "denied",
            functionality_storage: "granted",
            personalization_storage: "granted",
            security_storage: "granted",
        };

        if (readCookie("google-consent") != null)
            gtag("consent", "update", allGranted);
    </script>
    <script async src="https://www.googletagmanager.com/gtag/js?id=G-FZVQLLDS0B"></script>
    <!-- Create one update function for each consent parameter -->

    <!-- Google Tag Manager -->
    <script>
        (function (w, d, s, l, i) {
            w[l] = w[l] || [];
            w[l].push({ "gtm.start": new Date().getTime(), event: "gtm.js" });
            var f = d.getElementsByTagName(s)[0],
                j = d.createElement(s),
                dl = l != "dataLayer" ? "&l=" + l : "";
            j.async = true;
            j.src = "https://www.googletagmanager.com/gtm.js?id=" + i + dl;
            f.parentNode.insertBefore(j, f);
        })(window, document, "script", "dataLayer", "GTM-FZVQLLDS0B");
    </script>
    <!-- End Google Tag Manager -->
    <style>
        .bl {
            background-color: black;
        }

        h3 {
            text-transform: uppercase;
        }

        h1 {
            text-transform: capitalize;
        }

        .shareButton {
    position: relative;
    z-index: 1000;
    padding: 10px;
    border-radius: 50%;
    background-color: #007bff;
    color: white;
    border: none;
    cursor: pointer;
}

.shareOptions {
    position: absolute;
    right: 10%;
    display: none;
}

.share-item {
    position: absolute;
    list-style-type: none;
    transition: all 0.5s ease-out;
    opacity: 0;
}

.share-item a {
    display: flex;
    justify-content: center;
    align-items: center;
    width: 40px;
    height: 40px;
    border-radius: 50%;
    /* background-color: #f0f0f0; */
    color: #333;
    text-decoration: none;
    box-shadow: 0 2px 5px rgba(0,0,0,0.2);
}

.share-item a:hover {
    background-color: #e0e0e0;
}
.comments-sec{
    padding-inline: 5vw;
}
.user-comments{
    padding: 2vw 0;
    display: flex;
    justify-content: space-between;
    flex-wrap: wrap;
    gap: 1vw;
}
.user-comments img{
    /* margin: auto; */
    height: 4vw;
    width: 4vw;
    border-radius: 50%;
    border: 3px solid grey;
}
.comments h3{
    font-size: 1.7vw;
}
.comment{
    border: 5px solid #c0b9b963;
    border-radius: 0vw;
    padding: 1vw;
    width: 32%;
    display: grid;
    gap: 0.7vw;
}
.comment h4{
    font-size: 1.4vw;
    text-align: center;
}
.com-des{
    display: grid;
    gap: 0.7vw;
}
.com-des p{
    font-size: 1.3vw;
    height: 6vw;
}
.comment small{
    text-align: end;
    color: #607D8B;
}
.comment-form h3{
    font-size: 2vw;
    margin-bottom: 1vw;
}
.comment-form{
    padding-bottom: 3vw;
    width: 50%;
}
.comment-form form{
    display: grid;
    gap: 1vw;
}
.comment-form form input, .comment-form form textarea{
    outline: none;
    width: 100%;
    border: 0;
    background: #afbabe69;
    padding: 0.7vw 1vw;
    font-size: 1vw;
    border-radius: 0.3vw;
}
.comment-form form textarea{
    width: 100% !important;
    height: 10vw;
}
.comment-form form button{
    color: black;
    background: #C4C800;
    font-size: 1.2vw;
    font-weight: 600;
    padding: 1vw 1.2vw;
    border: 0;
    border-radius: 3vw;
}
.comment-form form button:hover{
    cursor: pointer;
}
@media screen and (max-width: 600px){
    .comment {
        border: 5px solid #c0b9b963;
        border-radius: 0vw;
        padding: 1vw;
        width: 48%;
        display: grid;
        gap: 0.7vw;
    }
    .user-comments img {
        /* margin: auto; */
        height: 5vw;
        width: 5vw;
        border-radius: 50%;
        border: 3px solid grey;
    }
    .comment h4 {
        font-size: 2.4vw;
        text-align: center;
    }
    .com-des p {
        font-size: 2vw;
        height: 11vw;
    }
    .comment small {
        font-size: 1.5vw;
        text-align: end;
        color: #607D8B;
    }
    .comment-form form input, .comment-form form textarea {
        outline: none;
        width: 100%;
        border: 0;
        background: #afbabe69;
        padding: 1.7vw 2vw;
        font-size: 3vw;
        border-radius: 0.3vw;
    }
    .comment-form {
        padding-bottom: 3vw;
        width: 80%;
    }
    .comment-form form button {
        color: black;
        background: #C4C800;
        font-size: 2.8vw;
        font-weight: 550;
        padding: 2vw 3vw;
        border: 0;
        border-radius: 4vw;
    }
}
</style>
/* Add Font Awesome for icons */
</head>

<body>
    <%- include("./includes/navbar") %>
        <div class="main-page">

            <div class="header">
                <div class="banner">
                    <img src="<%= blog.bannerImage %>" alt="Banner Image">
                    <h1>
                        <%= blog.title %>
                    </h1>
                </div>
            </div>

            <!-- blog share option -->
            <div style="display: flex;justify-content: end;padding-inline: 6vw;">
                <button class="shareButton">Share</button>
                <div class="shareOptions" style="display:none;">
                    <!-- Share options will be inserted here -->
                </div>
            </div>
            
            <!-- blog share option -->


            <section class="blog-content">
                <p>
                    <%= blog.shortDescription %>
                </p>
                <% blog.content.forEach((contentItem, index)=> { %>
                    <div
                        class="image-container<%= index % 2 === 0 ? '1' : '2' %> ic <%= !contentItem.image ? 'no-image' : '' %>">
                        <div class="ic-text">
                            <h3>
                                <%= contentItem.heading %>
                            </h3>
                            <p>
                                <%= contentItem.paragraph %>
                            </p>
                        </div>
                        <% if (contentItem.image) { %>
                            <div class="ic-img">
                                <img src="<%= contentItem.image %>" alt="Blog Image">
                            </div>
                            <% } %>
                    </div>


                    <% }) %>
                        <div class="contentText">
                            <%- blog.contentText %>
                        </div>
            </section>

            
            <div class="comments-sec">
                <section class="comments">
                    <div style="display: flex;justify-content: space-between;align-items: center;">
                        <h3>Comments</h3>
                        <button style="margin-right: 1vw;" class="shareButton">Share</button>
                        <div class="shareOptions" style="display:none;">
                            <!-- Share options will be inserted here -->
                        </div>
                    </div>
                    <% if (comments.length> 0) { %>
                        <div class="user-comments">
                            <% comments.forEach(comment=> { %>
                                <div class="comment">
                                    <div style="display: flex;gap: 1vw;align-items: center;">
                                        <img src="/assets/images/prof.png" alt="prof">
                                        <h4>
                                            <%= comment.name %>
                                        </h4>
                                    </div>
                                    <div class="com-des">
                                        <p>
                                            <%= comment.comment %>
                                        </p>
                                        <small>
                                            <%= comment.createdAt.toLocaleDateString() %>
                                        </small>
                                    </div>
                                </div>
                            <% }) %>
                        </div>
                                <% } else { %>
                                    <p>No comments yet.</p>
                                    <% } %>
                </section>


                <section class="comment-form">
                    <h3>Leave a Comment</h3>
                    <form action="/blog-detail/<%= blog.canonical %>/comment" method="POST">
                        <p style="display: flex;gap: 1vw;">
                            <input type="text" name="name" placeholder="Your Name" required>
                            <input type="email" name="email" placeholder="Your Email" required>
                        </p>
                        <p><textarea name="comment" placeholder="Your Comment" required></textarea></p>
                        <p><button type="submit">Submit Comment</button></p>
                    </form>
                </section>
            </div>


            <%- include("./includes/footer") %>
        </div>
        <script src="/js/script.js"></script>

        

        <script>
            document.addEventListener('DOMContentLoaded', function () {
                const commentForm = document.getElementById('comment-form');
                const commentsList = document.getElementById('comments-list');

                commentForm.addEventListener('submit', async (e) => {
                    e.preventDefault();
                    const name = document.getElementById('name').value;
                    const email = document.getElementById('email').value;
                    const comment = document.getElementById('comment').value;

                    try {
                        const response = await fetch(`/blog-detail/<%= blog.canonical %>/comment`, {
                            method: 'POST',
                            headers: {
                                'Content-Type': 'application/json',
                            },
                            body: JSON.stringify({ name, email, comment }),
                        });

                        if (response.ok) {
                            const newComment = await response.json();
                            displayComment(newComment);
                            commentForm.reset();
                        } else {
                            console.error('Failed to submit comment');
                        }
                    } catch (error) {
                        console.error('Error:', error);
                    }
                });

                function displayComment(comment) {
                    const commentElement = document.createElement('div');
                    commentElement.classList.add('comment');
                    commentElement.innerHTML = `
            <h4>${escapeHTML(comment.name)}</h4>
            <p>${escapeHTML(comment.comment)}</p>
            <small>${new Date(comment.createdAt).toLocaleString()}</small>
        `;
                    commentsList.prepend(commentElement);
                }

                function escapeHTML(str) {
                    return str.replace(/[&<>'"]/g,
                        tag => ({
                            '&': '&amp;',
                            '<': '&lt;',
                            '>': '&gt;',
                            "'": '&#39;',
                            '"': '&quot;'
                        }[tag] || tag)
                    );
                }

                // Display existing comments
                eval(`
    <% if (blog.comments && blog.comments.length > 0) { %>
        <% blog.comments.forEach(function(comment) { %>
            displayComment({
                name: '<%= comment.name %>',
                comment: '<%= comment.comment %>',
                createdAt: '<%= comment.createdAt %>'
            });
        <% }); %>
    <% } %>
`);
            });
        </script>
<script>
    const shareButtons = document.querySelectorAll('.shareButton');
const shareOptionsContainers = document.querySelectorAll('.shareOptions');

const shareLinks = [
    { name: 'Facebook', url: 'https://www.facebook.com/sharer/sharer.php?u=', svg: '<svg viewBox="0 0 24 24"><path d="M18.77 7.46H14.5v-1.9c0-.9.6-1.1 1-1.1h3V.5h-4.33C10.24.5 9.5 3.44 9.5 5.32v2.15h-3v4h3v12h5v-12h3.85l.42-4z"/></svg>' },
    { name: 'Twitter', url: 'https://twitter.com/messages/compose?text=', svg: '<svg viewBox="0 0 24 24"><path d="M23.44 4.83c-.8.37-1.5.38-2.22.02.93-.56.98-.96 1.32-2.02-.88.52-1.86.9-2.9 1.1-.82-.88-2-1.43-3.3-1.43-2.5 0-4.55 2.04-4.55 4.54 0 .36.03.7.1 1.04-3.77-.2-7.12-2-9.36-4.75-.4.67-.6 1.45-.6 2.3 0 1.56.8 2.95 2 3.77-.74-.03-1.44-.23-2.05-.57v.06c0 2.2 1.56 4.03 3.64 4.44-.67.2-1.37.2-2.06.08.58 1.8 2.26 3.12 4.25 3.16C5.78 18.1 3.37 18.74 1 18.46c2 1.3 4.4 2.04 6.97 2.04 8.35 0 12.92-6.92 12.92-12.93 0-.2 0-.4-.02-.6.9-.63 1.96-1.22 2.56-2.14z"/></svg>' },
    { name: 'WhatsApp', url: 'https://wa.me/?text=', svg: '<svg viewBox="0 0 24 24"><path d="M20.1 3.9C17.9 1.7 15 .5 12 .5 5.8.5.7 5.6.7 11.9c0 2 .5 3.9 1.5 5.6L.6 23.4l6-1.6c1.6.9 3.5 1.3 5.4 1.3 6.3 0 11.4-5.1 11.4-11.4-.1-2.8-1.2-5.7-3.3-7.8zM12 21.4c-1.7 0-3.3-.5-4.8-1.3l-.4-.2-3.5 1 1-3.4L4 17c-1-1.5-1.4-3.2-1.4-5.1 0-5.2 4.2-9.4 9.4-9.4 2.5 0 4.9 1 6.7 2.8 1.8 1.8 2.8 4.2 2.8 6.7-.1 5.2-4.3 9.4-9.5 9.4zm5.1-7.1c-.3-.1-1.7-.9-1.9-1-.3-.1-.5-.1-.7.1-.2.3-.8 1-.9 1.1-.2.2-.3.2-.6.1s-1.2-.5-2.3-1.4c-.9-.8-1.4-1.7-1.6-2-.2-.3 0-.5.1-.6s.3-.3.4-.5c.2-.1.3-.3.4-.5.1-.2 0-.4 0-.5C10 9 9.3 7.6 9 7c-.1-.4-.4-.3-.5-.3h-.6s-.4.1-.7.3c-.3.3-1 1-1 2.4s1 2.8 1.1 3c.1.2 2 3.1 4.9 4.3.7.3 1.2.5 1.6.6.7.2 1.3.2 1.8.1.6-.1 1.7-.7 1.9-1.3.2-.7.2-1.2.2-1.3-.1-.3-.3-.4-.6-.5z"/></svg>' },
    { name: 'Telegram', url: 'https://t.me/share/url?url=', svg: '<svg viewBox="0 0 24 24"><path d="M9.78 18.65l.28-4.23 7.68-6.92c.34-.31-.07-.46-.52-.19L7.74 13.3 3.64 12c-.88-.25-.89-.86.2-1.3l15.97-6.16c.73-.33 1.43.18 1.15 1.3l-2.72 12.81c-.19.91-.74 1.13-1.5.71L12.6 16.3l-1.99 1.93c-.23.23-.42.42-.83.42z"/></svg>' },
    { name: 'LinkedIn', url: 'https://www.linkedin.com/messaging/', svg: '<svg viewBox="0 0 24 24"><path d="M6.5 21.5h-5v-13h5v13zM4 6.5C2.5 6.5 1.5 5.3 1.5 4s1-2.4 2.5-2.4c1.6 0 2.5 1 2.6 2.5 0 1.4-1 2.5-2.6 2.5zm11.5 6c-1 0-2 1-2 2v7h-5v-13h5V10s1.6-1.5 4-1.5c3 0 5 2.2 5 6.3v6.7h-5v-7c0-1-1-2-2-2z"/></svg>' },
    { name: 'Email', url: 'mailto:?body=', svg: '<svg viewBox="0 0 24 24"><path d="M20 4H4c-1.1 0-1.99.9-1.99 2L2 18c0 1.1.9 2 2 2h16c1.1 0 2-.9 2-2V6c0-1.1-.9-2-2-2zm0 4l-8 5-8-5V6l8 5 8-5v2z"/></svg>' },
    { name: 'SMS', url: 'sms:?body=', svg: '<svg viewBox="0 0 24 24"><path d="M20 2H4c-1.1 0-2 .9-2 2v18l4-4h14c1.1 0 2-.9 2-2V4c0-1.1-.9-2-2-2zm0 14H5.17L4 17.17V4h16v12zM7 9h2v2H7zm4 0h2v2h-2zm4 0h2v2h-2z"/></svg>' },
    { name: 'Instagram', url: 'https://www.instagram.com/', svg: '<svg viewBox="0 0 24 24"><path d="M12 2.163c3.204 0 3.584.012 4.85.07 3.252.148 4.771 1.691 4.919 4.919.058 1.265.069 1.645.069 4.849 0 3.205-.012 3.584-.069 4.849-.149 3.225-1.664 4.771-4.919 4.919-1.266.058-1.644.07-4.85.07-3.204 0-3.584-.012-4.849-.07-3.26-.149-4.771-1.699-4.919-4.92-.058-1.265-.07-1.644-.07-4.849 0-3.204.013-3.583.07-4.849.149-3.227 1.664-4.771 4.919-4.919 1.266-.057 1.645-.069 4.849-.069zm0-2.163c-3.259 0-3.667.014-4.947.072-4.358.2-6.78 2.618-6.98 6.98-.059 1.281-.073 1.689-.073 4.948 0 3.259.014 3.668.072 4.948.2 4.358 2.618 6.78 6.98 6.98 1.281.058 1.689.072 4.948.072 3.259 0 3.668-.014 4.948-.072 4.354-.2 6.782-2.618 6.979-6.98.059-1.28.073-1.689.073-4.948 0-3.259-.014-3.667-.072-4.947-.196-4.354-2.617-6.78-6.979-6.98-1.281-.059-1.69-.073-4.949-.073zm0 5.838c-3.403 0-6.162 2.759-6.162 6.162s2.759 6.163 6.162 6.163 6.162-2.759 6.162-6.163c0-3.403-2.759-6.162-6.162-6.162zm0 10.162c-2.209 0-4-1.79-4-4 0-2.209 1.791-4 4-4s4 1.791 4 4c0 2.21-1.791 4-4 4zm6.406-11.845c-.796 0-1.441.645-1.441 1.44s.645 1.44 1.441 1.44c.795 0 1.439-.645 1.439-1.44s-.644-1.44-1.439-1.44z"/></svg>' },
    { name: 'Copy Link', action: 'copyLink', svg: '<svg viewBox="0 0 24 24"><path d="M16 1H4c-1.1 0-2 .9-2 2v14h2V3h12V1zm3 4H8c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h11c1.1 0 2-.9 2-2V7c0-1.1-.9-2-2-2zm0 16H8V7h11v14z"/></svg>' }
];

function createShareOptions(container) {
    shareLinks.forEach((link) => {
        const li = document.createElement('li');
        li.className = 'share-item';
        
        const a = document.createElement('a');
        a.href = link.url ? link.url + encodeURIComponent(window.location.href) : '#';
        a.target = '_blank';
        a.rel = 'noopener noreferrer';
        a.innerHTML = link.svg;
        
        a.onclick = (e) => {
            e.preventDefault();
            handleShare(link);
        };
        
        li.appendChild(a);
        container.appendChild(li);
    });
}

// Function to detect if the device is mobile
function isMobileDevice() {
    return (typeof window.orientation !== "undefined") || (navigator.userAgent.indexOf('IEMobile') !== -1);
}

function handleShare(link) {
    const url = encodeURIComponent(window.location.href);
    const title = encodeURIComponent(document.title);
    switch(link.name) {
        case 'Facebook':
            window.open(`https://www.facebook.com/sharer/sharer.php?u=${url}`, 'facebook-share-dialog', 'width=626,height=436');
            break;
        case 'Twitter':
            window.open(`https://twitter.com/messages/compose?text=${title}%20${url}`, 'twitter-share-dialog', 'width=626,height=436');
            break;
        case 'LinkedIn':
            window.open(`https://www.linkedin.com/messaging/`, 'linkedin-share-dialog', 'width=626,height=436');
            break;
            case 'Instagram':
            if (isMobileDevice() && navigator.share) {
                navigator.share({
                    title: title,
                    url: url
                }).then(() => {
                    console.log('Thanks for sharing!');
                }).catch(console.error);
            } else {
                alert("Direct sharing to Instagram is not available on this device. Please copy the link and share it manually on Instagram.");
                copyLink();
            }
            break;
        case 'Copy Link':
            copyLink();
            break;
        default:
            window.open(link.url + url, '_blank');
    }
}

function toggleShareOptions(event) {
    const button = event.currentTarget;
    const container = button.nextElementSibling;
    const items = container.querySelectorAll('.share-item');
    const angleBetween = 360 / items.length;
    const radius = 80; // Adjust this value to change the circle size

    const isOpen = container.style.display === 'block';

    items.forEach((item, index) => {
        if (isOpen) {
            item.style.transform = `rotate(0deg) translate(0) rotate(0deg)`;
            item.style.opacity = '0';
        } else {
            const angle = index * angleBetween;
            const x = radius * Math.cos(angle * Math.PI / 180);
            const y = radius * Math.sin(angle * Math.PI / 180);
            item.style.transform = `rotate(${angle}deg) translate(${x}px, ${y}px) rotate(-${angle}deg)`;
            item.style.opacity = '1';
        }
    });

    container.style.display = isOpen ? 'none' : 'block';
}

function copyLink() {
    navigator.clipboard.writeText(window.location.href)
        .then(() => alert('Link copied to clipboard!'))
        .catch(err => console.error('Failed to copy: ', err));
}

// Initialize share options for each button
shareButtons.forEach((button, index) => {
    createShareOptions(shareOptionsContainers[index]);
    button.addEventListener('click', toggleShareOptions);
});

// Close the share options when clicking outside
document.addEventListener('click', (event) => {
    shareOptionsContainers.forEach((container, index) => {
        if (container.style.display === 'block' && 
            !shareButtons[index].contains(event.target) && 
            !container.contains(event.target)) {
            toggleShareOptions({ currentTarget: shareButtons[index] });
        }
    });
});
</script>
</body>

</html>